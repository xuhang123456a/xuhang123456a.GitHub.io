# 项目理解

- [gameObject]()
- [文件说明]()
- [函数说明]()
- [UI界面流程]()
- [游戏流程]()
- [读表操作]()
- [排序操作]()
- [lua]()
    - [lua对类的模拟]()
    - [lua函数]()

# gameObject

gameObject = Hierarchy面板上的物体 = UnityEngine对象

所有UnityEngine对象的操作都是C#脚本GameObjectExtensions上的拓展方法

# 文件说明

FixUIUtils：屏幕适配处理（return FixUIUtils）

debug_utils：键盘响应事件

GameHttp：

help：

# 函数说明

`g_loadTextureByCode() --加载图片，要改成self:loadSprite()`

# UI界面流程

UIDaily.lua

UIBase:ctor()

UIBase:initUI()

UIDaily:initUI()

UIDaily:createNode()

UIBase:createNode(csbPath,notNeedChangeX)

UIBase:createNodeFinished()

UIBase:init()

UIBase:onInit()

UIDaily:onInit()

# 游戏流程

![.png](image/.png)

# 读表操作

`g_tabSrc("TAB_DailyActive")`

```
--遍历表 创建有效序列数据表 返回值为数组表 [大表慎用]
function g_tabSrc(tabName, mode,_type)	--mode = 1转出来的是key表 否则转出来的是数组 表
    tabName = tabName
    g_readyload_tabs = g_readyload_tabs or {}
    if not g_readyload_tabs[tabName] then
        g_readyload_tabs[tabName] = 1
         if _type then
            loadLocalTabToKeyTab(tabName)
        else
            loadTabToKeyTab(tabName)
        end
    end
    if mode == nil then
        if LocalData and LocalData.myLocalDatas[tabName] and LocalData.myLocalDatas[tabName][0] then
            return LocalData.myLocalDatas[tabName][0]
        end
    else
        if LocalData and LocalData.myLocalDatas[tabName] and LocalData.myLocalDatas[tabName][1] then
            return LocalData.myLocalDatas[tabName][1]
        end
    end

	local tbRes = {}
	local tbSrc = g_tab(tabName)
	for k, v in pairs(tbSrc) do
		if k > 0 then
			local dt = g_tab(tabName, k)
            dt.id = k
			if mode == 1 then
				tbRes[k] = dt
			else
				table.insert(tbRes, dt)
			end
		end
	end
    if mode ~= 1 then
        table.sort(tbRes,function (a,b)
            return a.id < b.id
        end)
    end
    LocalData.myLocalDatas[tabName] = LocalData.myLocalDatas[tabName] or {}
    if mode == nil then
        if LocalData and not LocalData.myLocalDatas[tabName][0] then
            LocalData.myLocalDatas[tabName][0] = tbRes
        end
    else
        if LocalData and not LocalData.myLocalDatas[tabName][1] then
            LocalData.myLocalDatas[tabName][1] = tbRes
        end
    end
            
	return tbRes
end
```

# 排序操作

`g_sort_table_min(a,b,{"taskSort","Order"})`

```
function g_sort_table_min(a,b,sortNames)
    for i,v in ipairs(sortNames) do
        if a[v] ~= b[v] then
            return a[v] < b[v]
        end
    end
end
```

# lua

## lua对类的模拟

ItemHero:create(data)

BleachAwakenClient\Assets\Lua\src\cocos\cocos2d\functions.lua

Line:290

## lua函数

[Lua中的select函数用法](https://blog.csdn.net/yinhe888675/article/details/112228815)

%5BTOC%5D%0A%23%20gameObject%0AgameObject%20%3D%20Hierarchy%E9%9D%A2%E6%9D%BF%E4%B8%8A%E7%9A%84%E7%89%A9%E4%BD%93%20%3D%20UnityEngine%E5%AF%B9%E8%B1%A1%0A%E6%89%80%E6%9C%89UnityEngine%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%93%8D%E4%BD%9C%E9%83%BD%E6%98%AFC%23%E8%84%9A%E6%9C%ACGameObjectExtensions%E4%B8%8A%E7%9A%84%E6%8B%93%E5%B1%95%E6%96%B9%E6%B3%95%0A%0A%23%20%E6%96%87%E4%BB%B6%E8%AF%B4%E6%98%8E%0AFixUIUtils%EF%BC%9A%E5%B1%8F%E5%B9%95%E9%80%82%E9%85%8D%E5%A4%84%E7%90%86%EF%BC%88return%20FixUIUtils%EF%BC%89%0Adebug_utils%EF%BC%9A%E9%94%AE%E7%9B%98%E5%93%8D%E5%BA%94%E4%BA%8B%E4%BB%B6%0AGameHttp%EF%BC%9A%0Ahelp%EF%BC%9A%0A%0A%23%20%E5%87%BD%E6%95%B0%E8%AF%B4%E6%98%8E%0A%60g_loadTextureByCode()%20--%E5%8A%A0%E8%BD%BD%E5%9B%BE%E7%89%87%EF%BC%8C%E8%A6%81%E6%94%B9%E6%88%90self%3AloadSprite()%60%0A%0A%23%20UI%E7%95%8C%E9%9D%A2%E6%B5%81%E7%A8%8B%0AUIDaily.lua%0AUIBase%3Actor()%0AUIBase%3AinitUI()%0A%0AUIDaily%3AinitUI()%0AUIDaily%3AcreateNode()%0A%0AUIBase%3AcreateNode(csbPath%2CnotNeedChangeX)%0AUIBase%3AcreateNodeFinished()%0AUIBase%3Ainit()%0AUIBase%3AonInit()%0A%0AUIDaily%3AonInit()%0A%0A%23%20%E6%B8%B8%E6%88%8F%E6%B5%81%E7%A8%8B%0A!%5Ba3238e030d0292788ddcfca97536583f.png%5D(en-resource%3A%2F%2Fdatabase%2F1205%3A1)%0A%0A%0A%23%20%E8%AF%BB%E8%A1%A8%E6%93%8D%E4%BD%9C%0A%60g_tabSrc(%22TAB_DailyActive%22)%60%0A%60%60%60%0A--%E9%81%8D%E5%8E%86%E8%A1%A8%20%E5%88%9B%E5%BB%BA%E6%9C%89%E6%95%88%E5%BA%8F%E5%88%97%E6%95%B0%E6%8D%AE%E8%A1%A8%20%E8%BF%94%E5%9B%9E%E5%80%BC%E4%B8%BA%E6%95%B0%E7%BB%84%E8%A1%A8%20%5B%E5%A4%A7%E8%A1%A8%E6%85%8E%E7%94%A8%5D%0Afunction%20g_tabSrc(tabName%2C%20mode%2C_type)%09--mode%20%3D%201%E8%BD%AC%E5%87%BA%E6%9D%A5%E7%9A%84%E6%98%AFkey%E8%A1%A8%20%E5%90%A6%E5%88%99%E8%BD%AC%E5%87%BA%E6%9D%A5%E7%9A%84%E6%98%AF%E6%95%B0%E7%BB%84%20%E8%A1%A8%0A%20%20%20%20tabName%20%3D%20tabName%0A%20%20%20%20g_readyload_tabs%20%3D%20g_readyload_tabs%20or%20%7B%7D%0A%20%20%20%20if%20not%20g_readyload_tabs%5BtabName%5D%20then%0A%20%20%20%20%20%20%20%20g_readyload_tabs%5BtabName%5D%20%3D%201%0A%20%20%20%20%20%20%20%20%20if%20_type%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20loadLocalTabToKeyTab(tabName)%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20loadTabToKeyTab(tabName)%0A%20%20%20%20%20%20%20%20end%0A%20%20%20%20end%0A%20%20%20%20if%20mode%20%3D%3D%20nil%20then%0A%20%20%20%20%20%20%20%20if%20LocalData%20and%20LocalData.myLocalDatas%5BtabName%5D%20and%20LocalData.myLocalDatas%5BtabName%5D%5B0%5D%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20LocalData.myLocalDatas%5BtabName%5D%5B0%5D%0A%20%20%20%20%20%20%20%20end%0A%20%20%20%20else%0A%20%20%20%20%20%20%20%20if%20LocalData%20and%20LocalData.myLocalDatas%5BtabName%5D%20and%20LocalData.myLocalDatas%5BtabName%5D%5B1%5D%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20LocalData.myLocalDatas%5BtabName%5D%5B1%5D%0A%20%20%20%20%20%20%20%20end%0A%20%20%20%20end%0A%0A%09local%20tbRes%20%3D%20%7B%7D%0A%09local%20tbSrc%20%3D%20g_tab(tabName)%0A%09for%20k%2C%20v%20in%20pairs(tbSrc)%20do%0A%09%09if%20k%20%3E%200%20then%0A%09%09%09local%20dt%20%3D%20g_tab(tabName%2C%20k)%0A%20%20%20%20%20%20%20%20%20%20%20%20dt.id%20%3D%20k%0A%09%09%09if%20mode%20%3D%3D%201%20then%0A%09%09%09%09tbRes%5Bk%5D%20%3D%20dt%0A%09%09%09else%0A%09%09%09%09table.insert(tbRes%2C%20dt)%0A%09%09%09end%0A%09%09end%0A%09end%0A%20%20%20%20if%20mode%20~%3D%201%20then%0A%20%20%20%20%20%20%20%20table.sort(tbRes%2Cfunction%20(a%2Cb)%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20a.id%20%3C%20b.id%0A%20%20%20%20%20%20%20%20end)%0A%20%20%20%20end%0A%20%20%20%20LocalData.myLocalDatas%5BtabName%5D%20%3D%20LocalData.myLocalDatas%5BtabName%5D%20or%20%7B%7D%0A%20%20%20%20if%20mode%20%3D%3D%20nil%20then%0A%20%20%20%20%20%20%20%20if%20LocalData%20and%20not%20LocalData.myLocalDatas%5BtabName%5D%5B0%5D%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20LocalData.myLocalDatas%5BtabName%5D%5B0%5D%20%3D%20tbRes%0A%20%20%20%20%20%20%20%20end%0A%20%20%20%20else%0A%20%20%20%20%20%20%20%20if%20LocalData%20and%20not%20LocalData.myLocalDatas%5BtabName%5D%5B1%5D%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20LocalData.myLocalDatas%5BtabName%5D%5B1%5D%20%3D%20tbRes%0A%20%20%20%20%20%20%20%20end%0A%20%20%20%20end%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%09return%20tbRes%0Aend%0A%60%60%60%0A%0A%23%20%E6%8E%92%E5%BA%8F%E6%93%8D%E4%BD%9C%0A%60g_sort_table_min(a%2Cb%2C%7B%22taskSort%22%2C%22Order%22%7D)%60%0A%60%60%60%0Afunction%20g_sort_table_min(a%2Cb%2CsortNames)%0A%20%20%20%20for%20i%2Cv%20in%20ipairs(sortNames)%20do%0A%20%20%20%20%20%20%20%20if%20a%5Bv%5D%20~%3D%20b%5Bv%5D%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20a%5Bv%5D%20%3C%20b%5Bv%5D%0A%20%20%20%20%20%20%20%20end%0A%20%20%20%20end%0Aend%0A%60%60%60%0A%0A%23%20lua%0A%23%23%20lua%E5%AF%B9%E7%B1%BB%E7%9A%84%E6%A8%A1%E6%8B%9F%0AItemHero%3Acreate(data)%0ABleachAwakenClient%5CAssets%5CLua%5Csrc%5Ccocos%5Ccocos2d%5Cfunctions.lua%0ALine%3A290%0A%23%23%20lua%E5%87%BD%E6%95%B0%0A%5BLua%E4%B8%AD%E7%9A%84select%E5%87%BD%E6%95%B0%E7%94%A8%E6%B3%95%5D(https%3A%2F%2Fblog.csdn.net%2Fyinhe888675%2Farticle%2Fdetails%2F112228815)%0A
