---
layout: post
title: Lua
date: 2026-01-31 21:52:23 +0000
author: xuhang
tags: ["工作", "面试", "职业", "工作准备"]
---

# Lua

优化方法：1.尽量少使用全局变量，由于Lua默认是全局变量，所以很容易造成内存泄漏，尽量使用local限定。

2.在可能内存泄漏的地方先调用collectgarbage（“count”）获取内存的最初使用，然后在函数调用后进行collectgarbage（“collect”）收集，并使用collectgarbage（“count”）检测两次内存使用的差。或者手动进行显示的垃圾回收collectgarbage("step")

3.lua的弱引用__mode（table）：因为如果一个table1里面还有一个table2对象，那么即使将这个table2对象赋值为nil，它依然不会被垃圾回收，因为table1还保存着这个对象的引用，而显然这部分的引用是没有用的。为了告诉GC，这一部分引用是没有必要的，所以需要将其标记为弱引用，以方便GC对其进行回收。

通过设置该表的元方法__model 为“k”或者是“v”，为“k”即可说明该表的key所引用的表是弱引用 ，为“v”说明该表的value所对应